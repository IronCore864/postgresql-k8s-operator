{"uid":"4e6c90d4acc3b67e","name":"test_mattermost_db","fullName":"tests.integration.test_tls#test_mattermost_db","historyId":"cdae414860de0e7068bea24175d8d4b0","time":{"start":1718156169091,"stop":1718157078664,"duration":909573},"description":"Deploy Mattermost to test the 'db' relation.\n\n    Mattermost needs TLS enabled on PostgreSQL to correctly connect to it.\n\n    Args:\n        ops_test: The ops test framework\n    ","descriptionHtml":"<p>Deploy Mattermost to test the 'db' relation.</p>\n<pre><code>Mattermost needs TLS enabled on PostgreSQL to correctly connect to it.\n\nArgs:\n    ops_test: The ops test framework\n</code></pre>\n","status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop","time":{"start":1718156161471,"stop":1718156161472,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1718156161472,"stop":1718156161472,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1718156161472,"stop":1718156161702,"duration":230},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1718156169090,"stop":1718156169090,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Deploy Mattermost to test the 'db' relation.\n\n    Mattermost needs TLS enabled on PostgreSQL to correctly connect to it.\n\n    Args:\n        ops_test: The ops test framework\n    ","status":"passed","steps":[],"attachments":[{"uid":"ee59e66eb0d6b2c0","name":"log","source":"ee59e66eb0d6b2c0.txt","type":"text/plain","size":7611}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"ops_test::finalizer","time":{"start":1718157078665,"stop":1718157079043,"duration":378},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail::0","time":{"start":1718157078665,"stop":1718157078665,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1718157079044,"stop":1718157079044,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1718157079044,"stop":1718157079044,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1718157079044,"stop":1718157079044,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"group(1)"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration"},{"name":"suite","value":"test_tls"},{"name":"host","value":"fv-az2036-841"},{"name":"thread","value":"12433-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.test_tls"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"history":{"statistic":{"failed":1,"broken":12,"skipped":0,"passed":13,"unknown":0,"total":26},"items":[{"uid":"a5ab9a29edf3975a","reportUrl":"../2436//#testresult/a5ab9a29edf3975a","status":"passed","time":{"start":1718070313787,"stop":1718071111971,"duration":798184}},{"uid":"68047ed5ca168420","reportUrl":"../2426//#testresult/68047ed5ca168420","status":"passed","time":{"start":1718005112659,"stop":1718006039725,"duration":927066}},{"uid":"a0e050ce79467cc1","reportUrl":"../2422//#testresult/a0e050ce79467cc1","status":"passed","time":{"start":1717897418116,"stop":1717898249493,"duration":831377}},{"uid":"501165d340809e50","reportUrl":"../2419//#testresult/501165d340809e50","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/0","time":{"start":1717810864952,"stop":1717811169879,"duration":304927}},{"uid":"ee17c92f57b4ecbb","reportUrl":"../2414//#testresult/ee17c92f57b4ecbb","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/0","time":{"start":1717726043836,"stop":1717726466253,"duration":422417}},{"uid":"5cab85459f60687a","reportUrl":"../2404//#testresult/5cab85459f60687a","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: mattermost/1","time":{"start":1717637710226,"stop":1717638448890,"duration":738664}},{"uid":"2bf68134023ec4ee","reportUrl":"../2395//#testresult/2bf68134023ec4ee","status":"passed","time":{"start":1717551276240,"stop":1717552120005,"duration":843765}},{"uid":"55e11ade907d8bd","reportUrl":"../2381//#testresult/55e11ade907d8bd","status":"broken","statusDetails":"juju.errors.JujuAppError: App in error: postgresql-k8s","time":{"start":1717465178035,"stop":1717465188988,"duration":10953}},{"uid":"2cfeacb118c8fb3f","reportUrl":"../2377//#testresult/2cfeacb118c8fb3f","status":"passed","time":{"start":1717378687959,"stop":1717379554897,"duration":866938}},{"uid":"798c3c01ca077a4b","reportUrl":"../2376//#testresult/798c3c01ca077a4b","status":"passed","time":{"start":1717292028821,"stop":1717292838895,"duration":810074}},{"uid":"4774138e92f1a324","reportUrl":"../2375//#testresult/4774138e92f1a324","status":"passed","time":{"start":1717205485702,"stop":1717206432001,"duration":946299}},{"uid":"7baf1edaf58b71ee","reportUrl":"../2370//#testresult/7baf1edaf58b71ee","status":"passed","time":{"start":1717119147091,"stop":1717120011852,"duration":864761}},{"uid":"8bea1f5ac689a7f","reportUrl":"../2369//#testresult/8bea1f5ac689a7f","status":"passed","time":{"start":1717032749606,"stop":1717033540866,"duration":791260}},{"uid":"f44e0aad04594c7","reportUrl":"../2363//#testresult/f44e0aad04594c7","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-3_0142.log:2024-05-29 01:42:31 UTC [282]: user=operator,db=postgres,app=[unknown],client=10.1.0.173,line=5 LOG:  statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-3_0151.log:2024-05-29 01:51:40 UTC [4879]: user=operator,db=postgres,app=[unknown],client=10.1.0.173,line=4 LOG:  statement: CREATE TABLE pgrewindtest (testcol INT);\\n'","time":{"start":1716946880644,"stop":1716947688022,"duration":807378}},{"uid":"1346ef01e9d9df69","reportUrl":"../2354//#testresult/1346ef01e9d9df69","status":"passed","time":{"start":1716860018483,"stop":1716860883414,"duration":864931}},{"uid":"7c3197a57fe9b457","reportUrl":"../2347//#testresult/7c3197a57fe9b457","status":"passed","time":{"start":1716773525400,"stop":1716774355767,"duration":830367}},{"uid":"72edb6a87f5641c7","reportUrl":"../2346//#testresult/72edb6a87f5641c7","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/0","time":{"start":1716687139876,"stop":1716687591036,"duration":451160}},{"uid":"cfa615f4666fc5a5","reportUrl":"../2345//#testresult/cfa615f4666fc5a5","status":"passed","time":{"start":1716600665167,"stop":1716601524959,"duration":859792}},{"uid":"309d9e395fa7db31","reportUrl":"../2341//#testresult/309d9e395fa7db31","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/1 [executing] active:","time":{"start":1716514568984,"stop":1716515570909,"duration":1001925}},{"uid":"9cfc8cf0a192c43f","reportUrl":"../2337//#testresult/9cfc8cf0a192c43f","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/0","time":{"start":1716428068005,"stop":1716428332187,"duration":264182}}]},"tags":["asyncio","group(1)"]},"source":"4e6c90d4acc3b67e.json","parameterValues":[]}