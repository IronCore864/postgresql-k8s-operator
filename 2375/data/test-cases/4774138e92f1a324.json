{"uid":"4774138e92f1a324","name":"test_mattermost_db","fullName":"tests.integration.test_tls#test_mattermost_db","historyId":"cdae414860de0e7068bea24175d8d4b0","time":{"start":1717205485702,"stop":1717206432001,"duration":946299},"description":"Deploy Mattermost to test the 'db' relation.\n\n    Mattermost needs TLS enabled on PostgreSQL to correctly connect to it.\n\n    Args:\n        ops_test: The ops test framework\n    ","descriptionHtml":"<p>Deploy Mattermost to test the 'db' relation.</p>\n<pre><code>Mattermost needs TLS enabled on PostgreSQL to correctly connect to it.\n\nArgs:\n    ops_test: The ops test framework\n</code></pre>\n","status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop","time":{"start":1717205476609,"stop":1717205476610,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1717205476610,"stop":1717205476610,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1717205476610,"stop":1717205476873,"duration":263},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1717205485702,"stop":1717205485702,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Deploy Mattermost to test the 'db' relation.\n\n    Mattermost needs TLS enabled on PostgreSQL to correctly connect to it.\n\n    Args:\n        ops_test: The ops test framework\n    ","status":"passed","steps":[],"attachments":[{"uid":"44517c32f50f1372","name":"log","source":"44517c32f50f1372.txt","type":"text/plain","size":8230}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"abort_on_fail::0","time":{"start":1717206432001,"stop":1717206432001,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test::finalizer","time":{"start":1717206432002,"stop":1717206432357,"duration":355},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1717206432358,"stop":1717206432358,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1717206432358,"stop":1717206432358,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1717206432358,"stop":1717206432359,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"group(1)"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration"},{"name":"suite","value":"test_tls"},{"name":"host","value":"fv-az1113-275"},{"name":"thread","value":"12461-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.test_tls"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"history":{"statistic":{"failed":1,"broken":8,"skipped":0,"passed":6,"unknown":0,"total":15},"items":[{"uid":"7baf1edaf58b71ee","reportUrl":"../2370//#testresult/7baf1edaf58b71ee","status":"passed","time":{"start":1717119147091,"stop":1717120011852,"duration":864761}},{"uid":"8bea1f5ac689a7f","reportUrl":"../2369//#testresult/8bea1f5ac689a7f","status":"passed","time":{"start":1717032749606,"stop":1717033540866,"duration":791260}},{"uid":"f44e0aad04594c7","reportUrl":"../2363//#testresult/f44e0aad04594c7","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-3_0142.log:2024-05-29 01:42:31 UTC [282]: user=operator,db=postgres,app=[unknown],client=10.1.0.173,line=5 LOG:  statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-3_0151.log:2024-05-29 01:51:40 UTC [4879]: user=operator,db=postgres,app=[unknown],client=10.1.0.173,line=4 LOG:  statement: CREATE TABLE pgrewindtest (testcol INT);\\n'","time":{"start":1716946880644,"stop":1716947688022,"duration":807378}},{"uid":"1346ef01e9d9df69","reportUrl":"../2354//#testresult/1346ef01e9d9df69","status":"passed","time":{"start":1716860018483,"stop":1716860883414,"duration":864931}},{"uid":"7c3197a57fe9b457","reportUrl":"../2347//#testresult/7c3197a57fe9b457","status":"passed","time":{"start":1716773525400,"stop":1716774355767,"duration":830367}},{"uid":"72edb6a87f5641c7","reportUrl":"../2346//#testresult/72edb6a87f5641c7","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/0","time":{"start":1716687139876,"stop":1716687591036,"duration":451160}},{"uid":"cfa615f4666fc5a5","reportUrl":"../2345//#testresult/cfa615f4666fc5a5","status":"passed","time":{"start":1716600665167,"stop":1716601524959,"duration":859792}},{"uid":"309d9e395fa7db31","reportUrl":"../2341//#testresult/309d9e395fa7db31","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/1 [executing] active:","time":{"start":1716514568984,"stop":1716515570909,"duration":1001925}},{"uid":"9cfc8cf0a192c43f","reportUrl":"../2337//#testresult/9cfc8cf0a192c43f","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/0","time":{"start":1716428068005,"stop":1716428332187,"duration":264182}},{"uid":"e3f783c73b7ac1c9","reportUrl":"../2333//#testresult/e3f783c73b7ac1c9","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/1 [executing] active: \n  postgresql-k8s/2 [executing] active:","time":{"start":1716341491471,"stop":1716342488389,"duration":996918}},{"uid":"ac5ea5d02b6f2e70","reportUrl":"../2330//#testresult/ac5ea5d02b6f2e70","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/1","time":{"start":1716255430064,"stop":1716255704307,"duration":274243}},{"uid":"f18db1d46229f448","reportUrl":"../2324//#testresult/f18db1d46229f448","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/2 [executing] active:","time":{"start":1716168844763,"stop":1716169847387,"duration":1002624}},{"uid":"e7653eb7a58a49c1","reportUrl":"../2323//#testresult/e7653eb7a58a49c1","status":"broken","statusDetails":"juju.errors.JujuAppError: App in error: postgresql-k8s","time":{"start":1716082328094,"stop":1716082338978,"duration":10884}},{"uid":"5eba6fe671f56c3b","reportUrl":"../2322//#testresult/5eba6fe671f56c3b","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/2 [executing] active:","time":{"start":1715995844231,"stop":1715996846732,"duration":1002501}}]},"tags":["asyncio","group(1)"]},"source":"4774138e92f1a324.json","parameterValues":[]}