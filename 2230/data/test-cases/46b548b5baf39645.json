{"uid":"46b548b5baf39645","name":"test_mattermost_db","fullName":"tests.integration.test_tls#test_mattermost_db","historyId":"cdae414860de0e7068bea24175d8d4b0","time":{"start":1714267961188,"stop":1714269217998,"duration":1256810},"description":"Deploy Mattermost to test the 'db' relation.\n\n    Mattermost needs TLS enabled on PostgreSQL to correctly connect to it.\n\n    Args:\n        ops_test: The ops test framework\n    ","descriptionHtml":"<p>Deploy Mattermost to test the 'db' relation.</p>\n<pre><code>Mattermost needs TLS enabled on PostgreSQL to correctly connect to it.\n\nArgs:\n    ops_test: The ops test framework\n</code></pre>\n","status":"passed","flaky":false,"newFailed":false,"newBroken":false,"newPassed":true,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"event_loop","time":{"start":1714267952069,"stop":1714267952070,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"tmp_path_factory","time":{"start":1714267952070,"stop":1714267952070,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"ops_test","time":{"start":1714267952070,"stop":1714267952332,"duration":262},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail","time":{"start":1714267961187,"stop":1714267961187,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"Deploy Mattermost to test the 'db' relation.\n\n    Mattermost needs TLS enabled on PostgreSQL to correctly connect to it.\n\n    Args:\n        ops_test: The ops test framework\n    ","status":"passed","steps":[],"attachments":[{"uid":"5a4fbd5183e30fa6","name":"log","source":"5a4fbd5183e30fa6.txt","type":"text/plain","size":9468}],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"ops_test::finalizer","time":{"start":1714269217999,"stop":1714269218557,"duration":558},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"abort_on_fail::0","time":{"start":1714269217999,"stop":1714269217999,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::2","time":{"start":1714269218558,"stop":1714269218558,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_close_event_loop","time":{"start":1714269218559,"stop":1714269218559,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"event_loop::_provide_clean_event_loop","time":{"start":1714269218559,"stop":1714269218559,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"stepsCount":0,"shouldDisplayMessage":false,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"group(1)"},{"name":"tag","value":"asyncio"},{"name":"parentSuite","value":"tests.integration"},{"name":"suite","value":"test_tls"},{"name":"host","value":"fv-az883-413"},{"name":"thread","value":"12818-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.integration.test_tls"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[],"history":{"statistic":{"failed":3,"broken":52,"skipped":0,"passed":22,"unknown":0,"total":77},"items":[{"uid":"45c65559b0d07522","reportUrl":"../2226//#testresult/45c65559b0d07522","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/2 [executing] active:","time":{"start":1714181430434,"stop":1714182432569,"duration":1002135}},{"uid":"ee3f45bc51ed533e","reportUrl":"../2221//#testresult/ee3f45bc51ed533e","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/2 [executing] active:","time":{"start":1714095200207,"stop":1714096202399,"duration":1002192}},{"uid":"338176487832e528","reportUrl":"../2208//#testresult/338176487832e528","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: mattermost/0","time":{"start":1714009013781,"stop":1714010137036,"duration":1123255}},{"uid":"eabde92ac9b622d3","reportUrl":"../2199//#testresult/eabde92ac9b622d3","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/1 [idle] active: \n  postgresql-k8s/2 [executing] active:","time":{"start":1713835968610,"stop":1713836970701,"duration":1002091}},{"uid":"3e352951730b8d7a","reportUrl":"../2186//#testresult/3e352951730b8d7a","status":"failed","statusDetails":"AssertionError: TLS is not being used on pg_rewind connections\nassert 'connection authorized: user=rewind database=postgres SSL enabled' in '/var/log/postgresql/postgresql-1_0132.log:2024-04-22 01:32:58 UTC [438]: user=operator,db=postgres,app=[unknown],client=10.1.0.130,line=5 LOG:  statement: GRANT ALL PRIVILEGES ON DATABASE postgres TO \"rewind\";\\n/var/log/postgresql/postgresql-1_0146.log:2024-04-22 01:46:59 UTC [4608]: user=operator,db=postgres,app=[unknown],client=10.1.0.130,line=4 LOG:  statement: CREATE TABLE pgrewindtest (testcol INT);\\n'","time":{"start":1713749469845,"stop":1713750608858,"duration":1139013}},{"uid":"e61069f8dc68e679","reportUrl":"../2176//#testresult/e61069f8dc68e679","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/2 [executing] active:","time":{"start":1713663127286,"stop":1713664129468,"duration":1002182}},{"uid":"2b41be058deadf50","reportUrl":"../2170//#testresult/2b41be058deadf50","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/2 [executing] active:","time":{"start":1713576672850,"stop":1713577669878,"duration":997028}},{"uid":"3ff13a3d75bd1910","reportUrl":"../2168//#testresult/3ff13a3d75bd1910","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/0","time":{"start":1713490287361,"stop":1713490518041,"duration":230680}},{"uid":"59dbe24b8efeb276","reportUrl":"../2166//#testresult/59dbe24b8efeb276","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/0 [executing] active: \n  postgresql-k8s/1 [executing] active:","time":{"start":1713403813940,"stop":1713404816188,"duration":1002248}},{"uid":"3547d618f815ec37","reportUrl":"../2161//#testresult/3547d618f815ec37","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/1 [executing] active: \n  postgresql-k8s/2 [executing] active:","time":{"start":1713317603274,"stop":1713318605814,"duration":1002540}},{"uid":"4c50c71466ecab","reportUrl":"../2156//#testresult/4c50c71466ecab","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/2","time":{"start":1713149911728,"stop":1713150125829,"duration":214101}},{"uid":"bef41818d75e936c","reportUrl":"../2154//#testresult/bef41818d75e936c","status":"broken","statusDetails":"juju.errors.JujuAppError: App in error: postgresql-k8s","time":{"start":1713058349986,"stop":1713058361214,"duration":11228}},{"uid":"528daa6c4417fb57","reportUrl":"../2153//#testresult/528daa6c4417fb57","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/1 [executing] active:","time":{"start":1712971516700,"stop":1712972518983,"duration":1002283}},{"uid":"f515856240461588","reportUrl":"../2151//#testresult/f515856240461588","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/0 [idle] waiting: awaiting for cluster to start\n  postgresql-k8s/1 [idle] waiting: awaiting for cluster to start\n  postgresql-k8s/2 [idle] active: Primary","time":{"start":1712885439420,"stop":1712886441342,"duration":1001922}},{"uid":"17c0db1f2d6ba2e8","reportUrl":"../2144//#testresult/17c0db1f2d6ba2e8","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/2 [executing] active:","time":{"start":1712799131707,"stop":1712800133999,"duration":1002292}},{"uid":"93d5afe087406805","reportUrl":"../2128//#testresult/93d5afe087406805","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/0","time":{"start":1712712776367,"stop":1712713032193,"duration":255826}},{"uid":"8038f1f142c69236","reportUrl":"../2112//#testresult/8038f1f142c69236","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/1 [executing] active:","time":{"start":1712539891220,"stop":1712540893271,"duration":1002051}},{"uid":"227a8f95a9dc84a8","reportUrl":"../2111//#testresult/227a8f95a9dc84a8","status":"broken","statusDetails":"juju.errors.JujuUnitError: Unit in error: postgresql-k8s/1","time":{"start":1712453461218,"stop":1712453696400,"duration":235182}},{"uid":"1935ffca72f9cb68","reportUrl":"../2110//#testresult/1935ffca72f9cb68","status":"passed","time":{"start":1712366965315,"stop":1712368255193,"duration":1289878}},{"uid":"68f12521b8bad61b","reportUrl":"../2106//#testresult/68f12521b8bad61b","status":"broken","statusDetails":"asyncio.exceptions.TimeoutError: Timed out waiting for model:\npostgresql-k8s/2 [executing] active:","time":{"start":1712280597490,"stop":1712281599631,"duration":1002141}}]},"tags":["asyncio","group(1)"]},"source":"46b548b5baf39645.json","parameterValues":[]}